<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã€UDæ•™ç§‘æ›¸ä½“ã€‘å°‚é–€ç”¨èª è¨˜æ†¶ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { 
            /* UDæ•™ç§‘æ›¸ä½“ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒã§ã®ã¿é©ç”¨ */
            font-family: 'UDæ•™ç§‘æ›¸ä½“', 'æ¸¸æ•™ç§‘æ›¸ä½“', 'Meiryo', sans-serif; 
            text-align: center; padding: 40px 20px; background-color: #f0f0f0; 
        }
        #word-container { font-size: 100px; font-weight: 700; margin: 20px auto; color: #004d40; height: 120px; line-height: 120px; visibility: hidden; }
        #timer { font-size: 28px; color: #d32f2f; margin-bottom: 20px; }
        #test-area { max-width: 650px; margin: 20px auto; }
        .word-input { margin: 5px; padding: 8px; font-size: 16px; width: 150px; text-align: center; border: 1px solid #ccc; display: inline-block; }
        button { padding: 15px 40px; font-size: 24px; cursor: pointer; background-color: #00796b; color: white; border: none; border-radius: 8px; margin-top: 30px; }
        .mail-link { display: inline-block; margin-top: 30px; padding: 15px 30px; background-color: #1976d2; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>ğŸ“š ã€UDæ•™ç§‘æ›¸ä½“ã€‘å°‚é–€ç”¨èªè¨˜æ†¶ãƒ†ã‚¹ãƒˆï¼ˆ10èª x 10ç§’ / é †ä¸åŒï¼‰</h1>
    <p id="instructions">ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãƒ†ã‚¹ãƒˆãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚1èªã«ã¤ã**10ç§’é–“**è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
    <div id="timer"></div>
    
    <div id="word-container"></div>
    
    <button id="start-button">ãƒ†ã‚¹ãƒˆé–‹å§‹</button>
    <div id="test-area" style="display: none;">
        <h2>ğŸ“ å˜èªã®å…¥åŠ›</h2>
        <p>è¡¨ç¤ºã•ã‚ŒãŸ10èªã‚’æ€ã„å‡ºã›ã‚‹é™ã‚Š**é †ä¸åŒ**ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
        <div id="input-fields"></div>
        <button id="check-button">çµæœã‚’ãƒã‚§ãƒƒã‚¯</button>
    </div>
    <div id="results-area"></div>
    
    <script>
        const RECIPIENT_EMAIL = "kurukuru190124@gmail.com"; 
        const WORD_LIST = [
            "Pericardium", "Neuropathy", "Immunology", "Hypothesis", "Paradigm", 
            "Sovereignty", "Mitigation", "Austerity", "Cognition", "Sustainability" 
        ];
        const DISPLAY_TIME = 10;
        let currentWordIndex = 0;
        let countdownInterval;
        let remainingWordsForCheck = [];

        function getElements() { return { wordContainer: document.getElementById('word-container'), timerDisplay: document.getElementById('timer'), testArea: document.getElementById('test-area'), startButton: document.getElementById('start-button'), resultsArea: document.getElementById('results-area'), instructions: document.getElementById('instructions'), inputFields: document.getElementById('input-fields'), checkButton: document.getElementById('check-button'), }; }

        function startTest(elements) {
            if(countdownInterval) clearInterval(countdownInterval); 
            elements.startButton.style.display = 'none';
            elements.testArea.style.display = 'none';
            elements.resultsArea.innerHTML = '';
            elements.instructions.textContent = 'å˜èªè¡¨ç¤ºä¸­... é›†ä¸­ã—ã¦è¦šãˆã¦ãã ã•ã„ã€‚';
            currentWordIndex = 0;
            elements.wordContainer.textContent = ''; 
            elements.wordContainer.style.visibility = 'visible';
            elements.inputFields.innerHTML = '';
            for(let i = 0; i < WORD_LIST.length; i++) {
                elements.inputFields.innerHTML += `<input type="text" id="word-${i}" class="word-input" placeholder="å›ç­” ${i + 1}">`;
            }
            displayWord(elements);
        }

        function displayWord(elements) {
            if (currentWordIndex < WORD_LIST.length) {
                const word = WORD_LIST[currentWordIndex];
                elements.wordContainer.textContent = word;
                let timeLeft = DISPLAY_TIME;
                elements.timerDisplay.textContent = `å˜èª ${currentWordIndex + 1} / ${WORD_LIST.length} - æ®‹ã‚Š ${timeLeft} ç§’`;
                countdownInterval = setInterval(() => {
                    timeLeft--;
                    elements.timerDisplay.textContent = `å˜èª ${currentWordIndex + 1} / ${WORD_LIST.length} - æ®‹ã‚Š ${timeLeft} ç§’`;
                    if (timeLeft <= 0) {
                        clearInterval(countdownInterval);
                        currentWordIndex++;
                        displayWord(elements);
                    }
                }, 1000);
            } else {
                endDisplayTime(elements);
            }
        }

        function endDisplayTime(elements) {
            elements.wordContainer.style.visibility = 'hidden';
            elements.wordContainer.textContent = ''; 
            elements.timerDisplay.textContent = "è¨˜æ†¶ãƒ†ã‚¹ãƒˆã®æ™‚é–“ã§ã™ã€‚";
            elements.instructions.textContent = 'æ€ã„å‡ºã›ã‚‹é™ã‚Šã€æ­£ç¢ºã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
            elements.testArea.style.display = 'block';
            document.getElementById('word-0').focus();
        }

        function checkResults(elements) {
            let correctCount = 0;
            let resultDetails = "--- å›ç­”ã®è©³ç´° ---\n";
            let userAnswers = [];
            remainingWordsForCheck = WORD_LIST.map(word => word.toUpperCase());
            for (let i = 0; i < WORD_LIST.length; i++) {
                const inputElement = document.getElementById(`word-${i}`);
                const userAnswer = inputElement.value.trim().toUpperCase();
                userAnswers.push(inputElement.value.trim());
                const correctIndex = remainingWordsForCheck.indexOf(userAnswer);
                if (userAnswer !== "" && correctIndex !== -1) {
                    correctCount++;
                    inputElement.style.backgroundColor = '#e8f5e9'; 
                    remainingWordsForCheck.splice(correctIndex, 1); 
                } else if (userAnswer !== "") {
                    inputElement.style.backgroundColor = '#ffebee'; 
                } else {
                    inputElement.style.backgroundColor = 'white';
                }
            }
            elements.resultsArea.innerHTML = `<h2>ğŸ‰ ãƒ†ã‚¹ãƒˆçµæœ ğŸ‰</h2><p>æ­£è§£æ•°: <strong style="color: blue;">${correctCount}</strong> / 10 èª</p><p>è¨˜æ†¶åŠ›å‘ä¸Šãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã«ãŠå½¹ç«‹ã¦ãã ã•ã„ï¼</p>`;
            let missedWords = WORD_LIST.filter(word => remainingWordsForCheck.includes(word.toUpperCase()));
            resultDetails += `--- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›å†…å®¹ ---\n`;
            userAnswers.forEach((answer, index) => { resultDetails += `å›ç­” ${index + 1}: ${answer}\n`; });
            resultDetails += `\n--- ä¸æ­£è§£/æœªå›ç­”ã®æ­£è§£å˜èª ---\n`;
            resultDetails += (missedWords.length > 0) ? missedWords.join(", ") + "\n" : "ãªã— (å…¨å•æ­£è§£ã®å¯èƒ½æ€§ã‚ã‚Š)\n";
            generateMailLink(correctCount, resultDetails, elements);
        }

        function generateMailLink(count, details, elements) {
            const subject = encodeURIComponent(`å°‚é–€ç”¨èªè¨˜æ†¶ãƒ†ã‚¹ãƒˆçµæœå ±å‘Š(UD): ${count} / 10 æ­£è§£`);
            let mailBody = `ã€é«˜åº¦å°‚é–€ç”¨èª è¨˜æ†¶ãƒ†ã‚¹ãƒˆçµæœï¼ˆUDæ•™ç§‘æ›¸ä½“ï¼‰ã€‘\n\n`;
            mailBody += `æ­£è§£æ•°: ${count} / 10 èª\nè¡¨ç¤ºæ™‚é–“: 1å˜èªã‚ãŸã‚Š ${DISPLAY_TIME} ç§’\n\n`;
            mailBody += `------------------------------------\n${details}------------------------------------\nã“ã®ãƒ¡ãƒ¼ãƒ«ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚`;
            const body = encodeURIComponent(mailBody);
            const mailtoLink = `mailto:${RECIPIENT_EMAIL}?subject=${subject}&body=${body}`;
            elements.resultsArea.innerHTML += `<a href="${mailtoLink}" class="mail-link" target="_blank">ğŸ“§ çµæœã‚’ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã™ã‚‹ (å®›å…ˆ: ${RECIPIENT_EMAIL})</a><p style="margin-top: 10px; font-size: 14px; color: #666;">ï¼ˆã“ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãŠä½¿ã„ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¾ã™ï¼‰</p>`;
            elements.startButton.style.display = 'none'; 
        }

        // æœ€çµ‚è§£æ±ºç­–: DOMContentLoadedãƒªã‚¹ãƒŠãƒ¼ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
        document.addEventListener('DOMContentLoaded', () => {
            const elements = getElements();
            elements.startButton.addEventListener('click', () => {
                startTest(elements);
            });
            elements.checkButton.addEventListener('click', () => {
                checkResults(elements);
            });
        });
    </script>
</body>
</html>